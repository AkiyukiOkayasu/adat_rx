cd ../.. && veryl fmt
[INFO ]   Processing file (/Users/akiyuki/Documents/AkiyukiProjects/adat_rx/src/adat_pkg.veryl)
[INFO ]   Processing file (/Users/akiyuki/Documents/AkiyukiProjects/adat_rx/src/adat_rx.veryl)
[INFO ]   Processing file (/Users/akiyuki/Documents/AkiyukiProjects/adat_rx/src/bit_decoder.veryl)
[INFO ]   Processing file (/Users/akiyuki/Documents/AkiyukiProjects/adat_rx/src/edge_detector.veryl)
[INFO ]   Processing file (/Users/akiyuki/Documents/AkiyukiProjects/adat_rx/src/frame_parser.veryl)
[INFO ]   Processing file (/Users/akiyuki/Documents/AkiyukiProjects/adat_rx/src/output_interface.veryl)
[INFO ]   Processing file (/Users/akiyuki/Documents/AkiyukiProjects/adat_rx/src/timing_tracker.veryl)
cd ../.. && veryl build
[INFO ]   Processing file (/Users/akiyuki/Documents/AkiyukiProjects/adat_rx/src/adat_pkg.veryl)
[INFO ]   Processing file (/Users/akiyuki/Documents/AkiyukiProjects/adat_rx/src/adat_rx.veryl)
[INFO ]   Processing file (/Users/akiyuki/Documents/AkiyukiProjects/adat_rx/src/bit_decoder.veryl)
[INFO ]   Processing file (/Users/akiyuki/Documents/AkiyukiProjects/adat_rx/src/edge_detector.veryl)
[INFO ]   Processing file (/Users/akiyuki/Documents/AkiyukiProjects/adat_rx/src/frame_parser.veryl)
[INFO ]   Processing file (/Users/akiyuki/Documents/AkiyukiProjects/adat_rx/src/output_interface.veryl)
[INFO ]   Processing file (/Users/akiyuki/Documents/AkiyukiProjects/adat_rx/src/timing_tracker.veryl)
[INFO ]   Processing file (/Users/akiyuki/Library/Caches/org.veryl-lang.veryl/std/a3a4d148de2d3d29212868cd267c76b84bd0d71675ed8ba5fc85c3698e7ed112/async_fifo/async_fifo.veryl)
[INFO ]   Processing file (/Users/akiyuki/Library/Caches/org.veryl-lang.veryl/std/a3a4d148de2d3d29212868cd267c76b84bd0d71675ed8ba5fc85c3698e7ed112/async_fifo/async_fifo_pkg.veryl)
[INFO ]   Processing file (/Users/akiyuki/Library/Caches/org.veryl-lang.veryl/std/a3a4d148de2d3d29212868cd267c76b84bd0d71675ed8ba5fc85c3698e7ed112/async_fifo/async_fifo_reset_sync.veryl)
[INFO ]   Processing file (/Users/akiyuki/Library/Caches/org.veryl-lang.veryl/std/a3a4d148de2d3d29212868cd267c76b84bd0d71675ed8ba5fc85c3698e7ed112/async_handshake/async_handshake.veryl)
[INFO ]   Processing file (/Users/akiyuki/Library/Caches/org.veryl-lang.veryl/std/a3a4d148de2d3d29212868cd267c76b84bd0d71675ed8ba5fc85c3698e7ed112/axi_if/axi_if.veryl)
[INFO ]   Processing file (/Users/akiyuki/Library/Caches/org.veryl-lang.veryl/std/a3a4d148de2d3d29212868cd267c76b84bd0d71675ed8ba5fc85c3698e7ed112/axi_if/axi_pkg.veryl)
[INFO ]   Processing file (/Users/akiyuki/Library/Caches/org.veryl-lang.veryl/std/a3a4d148de2d3d29212868cd267c76b84bd0d71675ed8ba5fc85c3698e7ed112/binary_enc_dec/binary_decoder.veryl)
[INFO ]   Processing file (/Users/akiyuki/Library/Caches/org.veryl-lang.veryl/std/a3a4d148de2d3d29212868cd267c76b84bd0d71675ed8ba5fc85c3698e7ed112/binary_enc_dec/binary_encoder.veryl)
[INFO ]   Processing file (/Users/akiyuki/Library/Caches/org.veryl-lang.veryl/std/a3a4d148de2d3d29212868cd267c76b84bd0d71675ed8ba5fc85c3698e7ed112/coding/linear_sec_decoder.veryl)
[INFO ]   Processing file (/Users/akiyuki/Library/Caches/org.veryl-lang.veryl/std/a3a4d148de2d3d29212868cd267c76b84bd0d71675ed8ba5fc85c3698e7ed112/coding/linear_sec_encoder.veryl)
[INFO ]   Processing file (/Users/akiyuki/Library/Caches/org.veryl-lang.veryl/std/a3a4d148de2d3d29212868cd267c76b84bd0d71675ed8ba5fc85c3698e7ed112/coding/test_linear_sec.veryl)
[INFO ]   Processing file (/Users/akiyuki/Library/Caches/org.veryl-lang.veryl/std/a3a4d148de2d3d29212868cd267c76b84bd0d71675ed8ba5fc85c3698e7ed112/counter/counter.veryl)
[INFO ]   Processing file (/Users/akiyuki/Library/Caches/org.veryl-lang.veryl/std/a3a4d148de2d3d29212868cd267c76b84bd0d71675ed8ba5fc85c3698e7ed112/countones/countones.veryl)
[INFO ]   Processing file (/Users/akiyuki/Library/Caches/org.veryl-lang.veryl/std/a3a4d148de2d3d29212868cd267c76b84bd0d71675ed8ba5fc85c3698e7ed112/countones/onehot.veryl)
[INFO ]   Processing file (/Users/akiyuki/Library/Caches/org.veryl-lang.veryl/std/a3a4d148de2d3d29212868cd267c76b84bd0d71675ed8ba5fc85c3698e7ed112/delay/delay.veryl)
[INFO ]   Processing file (/Users/akiyuki/Library/Caches/org.veryl-lang.veryl/std/a3a4d148de2d3d29212868cd267c76b84bd0d71675ed8ba5fc85c3698e7ed112/edge_detector/edge_detector.veryl)
[INFO ]   Processing file (/Users/akiyuki/Library/Caches/org.veryl-lang.veryl/std/a3a4d148de2d3d29212868cd267c76b84bd0d71675ed8ba5fc85c3698e7ed112/fifo/fifo.veryl)
[INFO ]   Processing file (/Users/akiyuki/Library/Caches/org.veryl-lang.veryl/std/a3a4d148de2d3d29212868cd267c76b84bd0d71675ed8ba5fc85c3698e7ed112/fifo/fifo_controller.veryl)
[INFO ]   Processing file (/Users/akiyuki/Library/Caches/org.veryl-lang.veryl/std/a3a4d148de2d3d29212868cd267c76b84bd0d71675ed8ba5fc85c3698e7ed112/gray/gray_counter.veryl)
[INFO ]   Processing file (/Users/akiyuki/Library/Caches/org.veryl-lang.veryl/std/a3a4d148de2d3d29212868cd267c76b84bd0d71675ed8ba5fc85c3698e7ed112/gray/gray_decoder.veryl)
[INFO ]   Processing file (/Users/akiyuki/Library/Caches/org.veryl-lang.veryl/std/a3a4d148de2d3d29212868cd267c76b84bd0d71675ed8ba5fc85c3698e7ed112/gray/gray_encoder.veryl)
[INFO ]   Processing file (/Users/akiyuki/Library/Caches/org.veryl-lang.veryl/std/a3a4d148de2d3d29212868cd267c76b84bd0d71675ed8ba5fc85c3698e7ed112/lfsr/lfsr_galois.veryl)
[INFO ]   Processing file (/Users/akiyuki/Library/Caches/org.veryl-lang.veryl/std/a3a4d148de2d3d29212868cd267c76b84bd0d71675ed8ba5fc85c3698e7ed112/pkg/types.veryl)
[INFO ]   Processing file (/Users/akiyuki/Library/Caches/org.veryl-lang.veryl/std/a3a4d148de2d3d29212868cd267c76b84bd0d71675ed8ba5fc85c3698e7ed112/ram/ram.veryl)
[INFO ]   Processing file (/Users/akiyuki/Library/Caches/org.veryl-lang.veryl/std/a3a4d148de2d3d29212868cd267c76b84bd0d71675ed8ba5fc85c3698e7ed112/selector/demux.veryl)
[INFO ]   Processing file (/Users/akiyuki/Library/Caches/org.veryl-lang.veryl/std/a3a4d148de2d3d29212868cd267c76b84bd0d71675ed8ba5fc85c3698e7ed112/selector/mux.veryl)
[INFO ]   Processing file (/Users/akiyuki/Library/Caches/org.veryl-lang.veryl/std/a3a4d148de2d3d29212868cd267c76b84bd0d71675ed8ba5fc85c3698e7ed112/selector/selector_pkg.veryl)
[INFO ]   Processing file (/Users/akiyuki/Library/Caches/org.veryl-lang.veryl/std/a3a4d148de2d3d29212868cd267c76b84bd0d71675ed8ba5fc85c3698e7ed112/selector/test_selector.veryl)
[INFO ]   Processing file (/Users/akiyuki/Library/Caches/org.veryl-lang.veryl/std/a3a4d148de2d3d29212868cd267c76b84bd0d71675ed8ba5fc85c3698e7ed112/slicer/slicer.veryl)
[INFO ]   Processing file (/Users/akiyuki/Library/Caches/org.veryl-lang.veryl/std/a3a4d148de2d3d29212868cd267c76b84bd0d71675ed8ba5fc85c3698e7ed112/slicer/slicer_unit_fb.veryl)
[INFO ]   Processing file (/Users/akiyuki/Library/Caches/org.veryl-lang.veryl/std/a3a4d148de2d3d29212868cd267c76b84bd0d71675ed8ba5fc85c3698e7ed112/slicer/slicer_unit_hb.veryl)
[INFO ]   Processing file (/Users/akiyuki/Library/Caches/org.veryl-lang.veryl/std/a3a4d148de2d3d29212868cd267c76b84bd0d71675ed8ba5fc85c3698e7ed112/synchronizer/synchronizer.veryl)
[INFO ]   Processing file (/Users/akiyuki/Library/Caches/org.veryl-lang.veryl/std/a3a4d148de2d3d29212868cd267c76b84bd0d71675ed8ba5fc85c3698e7ed112/synchronizer/synchronizer_basic.veryl)
[INFO ]       Output filelist (/Users/akiyuki/Documents/AkiyukiProjects/adat_rx/adat_rx.f)
verilator --cc --exe --build -j 0 -Wall -Wno-UNUSEDSIGNAL -Wno-UNUSEDPARAM -Wno-TIMESCALEMOD -Wno-WIDTHEXPAND -Wno-WIDTHTRUNC --timing --top-module tb_adat_rx -I../../target -Wno-DECLFILENAME ../../target/adat_pkg.sv ../../tests/tb_adat_rx.sv ../../tests/adat_generator.sv ../../target/edge_detector.sv ../../target/timing_tracker.sv ../../target/bit_decoder.sv ../../target/frame_parser.sv ../../target/output_interface.sv ../../target/adat_rx.sv sim_main.cpp
make: Nothing to be done for `default'.
- V e r i l a t i o n   R e p o r t: Verilator 5.044 2026-01-01 rev vUNKNOWN-built20260101
- Verilator: Built from 0.000 MB sources in 0 modules, into 0.000 MB in 0 C++ files needing 0.000 MB
- Verilator: Walltime 0.020 s (elab=0.000, cvt=0.000, bld=0.019); cpu 0.001 s on 8 threads; alloced 3.047 MB
./obj_dir/Vtb_adat_rx
-Info: ../../tests/tb_adat_rx.sv:712: $dumpvar ignored, as Verilated without --trace
Clock: 100MHz, Sample Rate: 48kHz
=== ADAT Receiver Test (Strict Comparison) ===

--- Monitoring first frame ---
Edge 1 detected at time 1105000: adat_in=1, synced=0
Edge 2 detected at time 1185000: adat_in=0, synced=1
Edge 3 detected at time 1345000: adat_in=1, synced=0
Edge 4 detected at time 1505000: adat_in=0, synced=1
Edge 5 detected at time 1825000: adat_in=1, synced=0
Total edges detected: 100
Frame 1 completed
Frame 2 completed
Frame 3 completed
Frame 4 completed
Frame 5 completed
Frame 6 completed
Frame 7 completed
Frame 8 completed
Frame 9 completed
Frame 10 completed

=== Metrics ===
bits_valid_count: 1470
bit_count_hist: 1bit=850, 2bit=380, 3bit=150, 4bit=60, 5bit=30
boundary_pass: ch0=10, ch1=10, ch2=10, ch3=10, ch4=10, ch5=10, ch6=10, ch7=10

=== Debug Info ===
adat_in: 0
ADAT edge: 0, Synced: 0
Frame time: 2048 (expected ~2083)
Max time: 25
Sync detect: 1
Bits valid: 0, Bit count: 1, Bits: 00001
Bit counter: 245, Shift reg: 2b7cefbf
Data valid: 0, Channel: 7
Frame cnt: 10
Locked: 1
PASS: Receiver locked

Starting strict data comparison...

Frame received, comparing all channels:
  Channel 0: PASS - 123456
  Channel 1: PASS - 789abc
  Channel 2: PASS - def012
  Channel 3: PASS - 345678
  Channel 4: PASS - 9abcde
  Channel 5: PASS - f01234
  Channel 6: PASS - 567890
  Channel 7: PASS - abcdef
  User data: PASS - a

Frame received, comparing all channels:
  Channel 0: PASS - 123456
  Channel 1: PASS - 789abc
  Channel 2: PASS - def012
  Channel 3: PASS - 345678
  Channel 4: PASS - 9abcde
  Channel 5: PASS - f01234
  Channel 6: PASS - 567890
  Channel 7: PASS - abcdef
  User data: PASS - a

Frame received, comparing all channels:
  Channel 0: PASS - 123456
  Channel 1: PASS - 789abc
  Channel 2: PASS - def012
  Channel 3: PASS - 345678
  Channel 4: PASS - 9abcde
  Channel 5: PASS - f01234
  Channel 6: PASS - 567890
  Channel 7: PASS - abcdef
  User data: PASS - a

Frame received, comparing all channels:
  Channel 0: PASS - 123456
  Channel 1: PASS - 789abc
  Channel 2: PASS - def012
  Channel 3: PASS - 345678
  Channel 4: PASS - 9abcde
  Channel 5: PASS - f01234
  Channel 6: PASS - 567890
  Channel 7: PASS - abcdef
  User data: PASS - a

Frame received, comparing all channels:
  Channel 0: PASS - 123456
  Channel 1: PASS - 789abc
  Channel 2: PASS - def012
  Channel 3: PASS - 345678
  Channel 4: PASS - 9abcde
  Channel 5: PASS - f01234
  Channel 6: PASS - 567890
  Channel 7: PASS - abcdef
  User data: PASS - a

=== Test Results ===
Frames sent: 10
Errors: 0
*** TEST PASSED ***

=== S/MUX2 Test (96kHz) ===
Debug: test_mode=1, adat_in_mux should be driven by adat_in_96k
Debug: Before starting gen_start_96k, adat_in_96k=0
Debug: After starting gen_start_96k:
  test_mode=1 (should be 1 for 96kHz)
  gen_start=0, gen_start_96k=1, gen_start_192k=0
  adat_in=0 (48kHz), adat_in_96k=0 (96kHz), adat_in_192k=0 (192kHz)
  adat_in_mux=0 (should match adat_in_96k)
  DUT seeing: i_adat=0 (from mux)
S/MUX2: Frame 1, locked=1, frame_time=570, have_prev_sync=1, frame_count=978
S/MUX2: Locked after 1 frames
S/MUX2: Waiting for frame_time to stabilize...
  frame_time=570, max_time=36
  frame_time=570, max_time=36
  frame_time=570, max_time=36
  frame_time=570, max_time=36
  frame_time=570, max_time=36
  frame_time=570, max_time=36
  frame_time=570, max_time=36
  frame_time=570, max_time=36
  frame_time=570, max_time=36
  frame_time=570, max_time=36
  frame_time=570, max_time=36
  frame_time=570, max_time=36
  frame_time=570, max_time=36
  frame_time=570, max_time=36
  frame_time=570, max_time=36
  frame_time=570, max_time=36
  frame_time=570, max_time=36
  frame_time=570, max_time=36
  frame_time=570, max_time=36
  frame_time=570, max_time=36
S/MUX2: FAIL - Sample rate detection error (expected Rate96kHz=1, got 2)
  Debug: frame_time=570 (expected ~1042 for 96kHz)
S/MUX2: FAIL - Timeout waiting for Frame 0
S/MUX2: FAIL

=== S/MUX4 Test (192kHz) ===
S/MUX4: Locked after frames
S/MUX4: Waiting for frame_time to stabilize...
  frame_time=3504, max_time=369
  frame_time=3504, max_time=369
  frame_time=3504, max_time=369
  frame_time=3504, max_time=369
  frame_time=3504, max_time=369
  frame_time=3504, max_time=369
  frame_time=3504, max_time=369
  frame_time=3504, max_time=369
  frame_time=3504, max_time=369
  frame_time=3504, max_time=369
  frame_time=3504, max_time=369
  frame_time=3504, max_time=369
  frame_time=3504, max_time=369
  frame_time=3504, max_time=369
  frame_time=3504, max_time=369
  frame_time=3504, max_time=369
  frame_time=3504, max_time=369
  frame_time=3504, max_time=369
  frame_time=3504, max_time=369
  frame_time=3504, max_time=369
S/MUX4: FAIL - Sample rate detection error (expected Rate192kHz=2, got 0)
  Debug: frame_time=3504 (expected ~521 for 192kHz)
S/MUX4: FAIL - Timeout waiting for Frame 0
S/MUX4: FAIL - Timeout waiting for Frame 1
S/MUX4: FAIL - Timeout waiting for Frame 2
S/MUX4: FAIL - Timeout waiting for Frame 3
  Logical Ch0: FAIL (expected 0xff0000)
    Frame0.Ch0=0x000000, Frame1.Ch2=0x000000, Frame2.Ch4=0x000000, Frame3.Ch6=0x000000
  Logical Ch1: FAIL (expected 0x00ffff)
    Frame0.Ch1=0x000000, Frame1.Ch3=0x000000, Frame2.Ch5=0x000000, Frame3.Ch7=0x000000
S/MUX4: FAIL
- ../../tests/tb_adat_rx.sv:706: Verilog $finish
